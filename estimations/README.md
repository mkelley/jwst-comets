# Brightness estimates

Author: Michael S. P. Kelley

## ETC power-law surface brightness profile

Cometary comae have surface brightness profiles that tend to follow a radial power-law. The ideal coma is proportional to 1/ρ, where ρ is the distance to the nucleus. The JWST ETC has a power-law surface brightness profile. This can be used for comets, but only with some care. An index of 1 reproduces the 1/ρ coma shape. However, the central core of the ETC power-law profile is flat. In order to faithfully reproduce a cometary scene, the central core must be smaller than the pixel size of the instrument in question.

Based on the script `etc-profile-test.py` and the notebook `etc-profile-notes.py`, I recommend the following:

- Generate the surface brightness of a coma averaged over an aperture of radius of 2 mas in units of mJy/arcsec^2.
- Upload this spectrum to the JWST ETC.
- Create a new source, using this spectrum as the continuum.
- Set "Do not renormalize" under the Renorm tab.
- Set the shape to "Power law":
  - normalize to per square arcsec
  - core radius to 0.001 arcsec (= 1 mas)
  - power law index to 1

There is a difference of a factor of 2 between the core radius and the aperture radius used in the coma flux estimation tool. This difference sets the correct normalization for the ETC coma surface brightness.

### Planetary Spectrum Generator Notes

The [GSFC Planetary Spectrum Generator](https://psg.gsfc.nasa.gov/) can be used to simulate cometary spectra for JWST. Using the small aperture recommended above may produce optically thick molecular bands, which the ETC will then reproduce in the surface brightness model. If the optically thin bands are more relevant for your comet ETC model, they can be generated by lowering the PSG model production rate and scaling the results back to your nominal production rate before uploading to the ETC.

## Brightness estimates

### jwst-comet-est.py

---

**Warning**

- Conversions from total visual magnitude to dust Afρ is experimental.

- **Gas output is not yet implemented.**

---

```
usage: jwst-comet-est.py [-h] [--aper APER] [-R R] [--unit UNIT] (--afrho AFRHO | -m M) [-y] [--dusty] [--gassy]
                         [--ef2af EF2AF] [--Tscale TSCALE] [-S S] [--wave0 WAVE0] [-o O]
                         rh delta

Generate model comet spectra for JWST ETC.

positional arguments:
  rh               heliocentric distance (au)
  delta            observer-target distance (au)

options:
  -h, --help       show this help message and exit
  --aper APER      aperture radius (arcsec), or one of: ifu, fs200, fs400, fs1600, lrs, mrs, nircam (default: 0.2 arcsec)
  -R R             spectral resolution (default: 10)
  --unit UNIT      output spectral flux density or surface brightness unit (default: mJy/arcsec2)
  --afrho AFRHO    dust brightness based on this Afρ at 0 deg phase (cm) (default: None)
  -m M             total visual magnitude that will be converted to Afρ (non-validated approach) (default: None)
  -y               accept that the conversion from m to Afρ has not been verified (default: False)
  --dusty, -d      indicates that the conversion from -m should assume a dusty coma, repeated options increase dust/gas:
                   Q/1.6|2.4|3.7, Afrho*4.8|23|110 (default: 0)
  --gassy, -g      indicates that the conversion from -m should assume a gassy coma, repeated options increase gas/dust:
                   Q*1.6|2.4|3.7, Afrho/4.8|23|110 (default: 0)
  -o O             save to this file name (default: None)

dust options:
  --ef2af EF2AF    the ratio εfρ/Afρ (default: 3.5)
  --Tscale TSCALE  LTE blackbody temperature scale factor (default: 1.1)
  -S S             redden the scattered spectrum with this gradient (%/100 nm) (default: 0)
  --wave0 WAVE0    normalization point for the spectral gradient (default: 0.6)

--gassy and --dusty can be repeatedly used to scale the results.
```

Generate a spectrum for a comet with Afρ=100 cm at rh=1.5 au, and Δ=1.0 au, as observed by MIRI LRS:

```
$ python3 jwst-comet-est.py 1.5 1.0 --afrho=100 --aper=lrs --unit=mJy
# %ECSV 1.0
# ---
# datatype:
# - {name: wave, unit: um, datatype: float64}
# - {name: total, unit: mJy, datatype: float64}
# - {name: F_sca, unit: mJy, datatype: float64}
# - {name: F_th, unit: mJy, datatype: float64}
# meta: !!omap
# - {cmd: ./jwst-comet-est.py 1.5 1.0 --afrho=100 --aper=lrs --unit=mJy}
# - {rh: 1.5 AU}
# - {delta: 1.0 AU}
# - {phase: 41.40962210927086 deg}
# - {aper: "Rectangular aperture, dimensions 0.5\xD71.6 arcsec"}
# - {phase function: 0.35918609535776413}
# - {ef2af: 3.5}
# - {Tscale: 1.1}
# - {Afrho: 100.0 cm}
# - {efrho: 350.0 cm}
# - {S: 0.0 % / 100 nm}
# - {wave0: 0.6 um}
# schema: astropy-2.0
wave total F_sca F_th
0.5 0.0940997500908742 0.0940997500908742 1.0884804987300252e-41
0.55 0.11078076852077103 0.11078076852077103 1.9340246088968733e-37
...
```
